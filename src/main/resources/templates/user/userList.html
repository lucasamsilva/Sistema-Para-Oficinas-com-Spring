<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://thmeleaf.org">

<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<!-- IMPORTAÇÃO DO JAVASCRIPT -->
<script type="text/javascript" th:src="@{/js/jquery/jquery.js}"></script>
<script type="text/javascript" th:src="@{/js/bootstrap/bootstrap.js}"></script>
<script type="text/javascript" src="https://cdn.datatables.net/v/dt/dt-1.10.20/datatables.min.js"></script>
<script type="text/javascript" th:src="@{/js/scripts/tabledata.js}"></script>
<script type="text/javascript" th:src="@{/js/scripts/header.js}"></script>

<!-- IMPORTAÇÃO DO CSS   -->
<link rel="stylesheet" th:href="@{/css/bootstrap/bootstrap.css}"></link>
<link rel="stylesheet" th:href="@{/css/font-awesome/css/font-awesome.css}"></link>
<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/v/dt/dt-1.10.20/datatables.min.css"/>


    <style>
        body {
            background-color: MintCream;
        }
    </style>

</head>

<body>
	<header id="cabecalho" class="mb-1"></header>
	<div class="p-2">
	<a href="/user/new" class="btn btn-success m-2"><i class="fa fa-user-plus m-1" aria-hidden="true"></i>Novo</a>
	<table id="myTable" class="table table-striped table-bordered">
		<thead class="bg-success">
			<tr>
				<th class="">Id</th>
				<th>Nome</th>
				<th>E-mail</th>
				<th>Ações</th>
			</tr>
		</thead>
		<tbody>
			<tr th:each="user :${listUsers}">
				<td th:text="${user.id}"></td>
				<td th:text="${user.username}"></td>
				<td th:text="${user.email}"></td>
				<td class="d-flex justify-content-end">
					<a class="btn btn-success btn-sm ali mr-1" th:href="@{/user/{id}(id=${user.id})}">Alterar</a>
					<button type="button" data-toggle="modal" data-target="#confirmacao" th:name="${user.id}" class="btn btn-danger btn-sm excluir">Excluir</button>
				</td>
			</tr>
		</tbody>
	</table>
</div>
	<div class="modal fade" id="confirmacao" tabindex="-1" role="dialog">
	  <div class="modal-dialog modal-dialog-centered" role="document">
	    <div class="modal-content">
	      <div class="modal-header">
	        <h5 class="modal-title">Confirma a exclusão ?</h5>
	      </div>
	      <div id="modaltexto" class="modal-body">
	        
	      </div>
	      <div class="modal-footer">
	        <button type="button" class="btn btn-success" data-dismiss="modal">Cancelar</button>
	        <button type="button" class="btn btn-danger" id="botaoconfirmacao">Excluir</button>
	      </div>
	    </div>
	  </div>
	</div>


</body>

<script>

	$(".excluir").click(function(){
		let id = $(this).attr("name");
		$("#modaltexto").html(`Deseja excluir o cadastro de ID = ${id}`);
		$("#botaoconfirmacao").attr("name", id);
	}
	);

	$("#botaoconfirmacao").click(function(){
		let id = $("#botaoconfirmacao").attr("name");
		$.ajax({
			url:`/user/delete/${id}`,
			type:'delete',
			success: function(){
				location.reload();
			}
		})	
	}
);
	

$( document ).ready(function() {
	$('select').addClass("custom-select").addClass("m-1");
	$('select').css("width","auto");
	$('input').addClass("form-control");
	$('label').addClass("d-flex").addClass("align-items-baseline");
});


</script>

</html>